<!DOCTYPE html>
<html>
<head>
	<title>	Compiler</title>
	<script src="./jquery-3.3.1.js"></script>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="author" content="venkat-mvs"/>
	<meta name="description" content="Compile,Run C Online "/>
</head>
<style>
#output{
	border: 2px solid black;
	width: 60%;
	overflow-x: hidden;
	padding-left: 10px;
}
#input{
	width: 60%;
	height: 60%;
}
#code{
	width:80%;
	height:70%;
}
</style>
<body>

<textarea name="code" rows=15 cols=100  id="code">

</textarea><br/>
    
<strong>Sample Input please:<br/></strong>
<textarea name="input" rows = 10 cols =100 id="input">

</textarea><br/><br/>
<input type="submit" value="Run" id="submit"><br/><br />
<div >
	<strong>Output:<br/></strong>
	   <textarea id="output" rows =10 wrap = "hard" readonly>

	   </textarea>
</div>
<script>
//$("button").on("click",function(){
var output = ''
$("#code").val("#include<iostream>\n#include<stdlib.h>\nusing namespace std;\nint main(){\n\tcout<<\"hello world\";\n}");
document.getElementById("submit").onclick = function(e){
	var object =
         {
             code: document.getElementById('code').value,
             input: document.getElementById('input').value                
         }
    $('#output').val('loading.........');
	var objectString = JSON.stringify(object);
	$.ajax({
        type: "POST",
        url: window.location.href,
        data:objectString ,
        success: function (data){
            console.log(data);
            output=data;
            $("#output").val(data.out);
        },
        error: function (data = "not here") {
            console.log('Error');
            console.log(data);
            $("#output").val('Erro.\n\n\n\n'+data.responseText);
        }
        });
	//alert(objectString);
}
function ajaxsend(data){
	var xhr = new XMLHttpRequest();
	xhr.open('POST','/index.html',true);
	/*xhr.onerror = function(e){
		data = e;
	}
	xhr.onreadystatechange = function(e){
			
	}*/
	
	xhr.send(data);
	if(xhr.readyState = XMLHyypRequest.DOE && xhr.status == 200)
	return xhr.response;
	else
	return xhr;
}
$("textarea").keydown(function(e) {
    if(e.keyCode === 9) { // tab was pressed
        // get caret position/selection
        var start = this.selectionStart;
        var end = this.selectionEnd;

        var $this = $(this);
        var value = $this.val();

        // set textarea value to: text before caret + tab + text after caret
        $this.val(value.substring(0, start)
                    + "\t"
                    + value.substring(end));

        // put caret at right position again (add one for the tab)
        this.selectionStart = this.selectionEnd = start + 1;

        // prevent the focus lose
        e.preventDefault();
    }
	else if(e.key == "Enter")
	{
		var start = this.selectionStart;
        	var end = this.selectionEnd;
		var $this = $(this);
		var value = $this.val();
		$this.val(value.substring(0,start)+"\n\t"+value.substring(end));
		this.selectionStart = this.selectionEnd = start + 2;
		e.preventDefault();
	}
	//$(this).val().split("\n").length
});
// });
// });
</script>
</body>
</html>

